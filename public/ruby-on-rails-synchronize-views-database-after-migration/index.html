<!doctypehtml><html lang=en><meta charset=utf-8><title>Rails 4: update/synchronize views with database schema after a migration - Simone Web Design</title><meta content="Simone Vittori"name=author><meta content="Blog about software development. Tips and tricks on JavaScript, Ruby, Elixir, Elm, and more. Simone Vittori is the author."name=description><meta content="width=device-width,initial-scale=1"name=viewport><link href=https://www.simonewebdesign.it/ruby-on-rails-synchronize-views-database-after-migration/ rel=canonical><link href='data:application/manifest+json,{"name":"Simone Web Design","short_name":"SimoneDesign","theme_color":"%23555","background_color":"%23f6f6f6","display":"minimal-ui","description":"A tech blog"}'rel=manifest><link href="data:image/svg+xml,%3csvg version='1.0' xmlns='http://www.w3.org/2000/svg' width='1288' height='1706.667' viewBox='0 0 966 1280'%3e%3cpath d='M415 47.7c-48.3 2.9-95.2 13.8-134.6 31.3-49.9 22.1-94.6 57.7-127.4 101.5C118.4 226.6 98.5 280 91.8 344c-1.6 16-1.6 62.1 0 76.5 6.5 56.5 23.1 102.8 52.5 146.8 38.8 58.1 96.4 104.6 169.8 137C338.2 715 346 717.7 497 768.5c69.7 23.4 85.3 29.2 113.3 42.2 32.5 15 54.9 29.4 72.3 46.8 20.8 20.6 31.4 40 37.6 68.8 3 13.8 3.3 48.3.5 62.1-5.6 27.4-17.3 50.3-36.2 70.3-37.2 39.6-88.3 59.3-153.5 59.3-72.7 0-136.2-25.5-198-79.6-51.9-45.3-101.8-115.9-141-199.3-9.8-20.9-23.9-53.7-30.5-71.4l-4.8-12.7H58.3l-2.2 2.3-2.2 2.4 7.6 145.9c14.4 279.1 15.5 299.9 16 301.1.3 1 9.9 1.3 43.4 1.3 23.6 0 43.2-.4 43.5-.8.2-.4 1-4.6 1.6-9.2 3.2-24.6 13.9-48.4 25.7-57.8 8.7-6.8 11.7-7.7 24.8-7.6 18.1.1 30.1 3.8 84 25.9 63.1 25.8 128.5 44.6 179.8 51.6 19.4 2.6 68.4 3.7 90.4 2 92.5-7.3 167.4-39.7 228.7-99.1 61.9-60 95.3-133.7 102.7-227.1 1.5-18.5.6-64.8-1.6-83.4-9.4-81-39-145.8-91-199.4-42.1-43.4-97.4-78.2-167.7-105.7-21.2-8.3-30.8-11.5-126.8-41.9-99-31.4-105.3-33.5-122.4-40.7-35.2-14.7-61.8-31.9-84.1-54.3-22-22-34.5-44.7-38.5-69.7-2-12.1-.8-34.9 2.4-47.1 5-19.5 15.5-37.3 30.4-52.2 26.2-25.9 59.2-41.3 103.7-48.1 9.6-1.5 17.6-1.9 40.5-1.9 25.3 0 29.9.3 41.3 2.3 77.4 13.9 141 59.2 200 142.5 20.3 28.5 35.9 55 56.8 96.2l15.7 31 38.9.3 38.9.2 2.8-2.9 2.8-2.9-7.7-146.4c-4.2-80.4-8.4-160.7-9.3-178.3l-1.7-32-38 .3c-20.9.2-38.3.7-38.6 1-.3.4-1.4 3.8-2.4 7.7-4.4 17.3-13.3 33.7-22.2 41.4-10.6 9-20.8 11.5-36 8.7-5.4-1-11.8-2.2-14.3-2.6-2.5-.5-12.8-4.6-23-9.3C590.2 70.9 524.9 52.6 470.5 48c-11.1-.9-42.6-1.1-55.5-.3z' fill='%23333'/%3e%3c/svg%3e"rel=icon><style>html{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;background:#f6f6f6;font-family:"PT Serif",Georgia,Times,"Times New Roman",serif;color:#333;border-top:3px solid #555}body{margin:0 1em}.projects li,time{font-family:"PT Sans","Helvetica Neue",Arial,sans-serif;font-size:85%;color:#aaa}main{max-width:65ch;margin:0 auto}h1,h2,h3,h4,h5,h6{margin-top:1.6em}header{text-align:center}header a{color:inherit;text-decoration:none}header+p{text-align:center}p{line-height:1.65}nav ul{padding-left:0}li+li{margin-top:.5rem}blockquote{font-style:italic;font-size:1.2em;line-height:1.5em;padding-left:1em;border-left:4px solid rgba(170,170,170,.5)}hr{border:0;border-top:1px dotted rgba(170,170,170,.5);margin:1.5rem}abbr[title]{text-decoration:none;border-bottom:1px dotted #aaa}@media (min-width:48rem){html{font-size:115%}article header{position:relative}.entry-title{width:95vw;position:relative;left:calc(50% - 95vw / 2)}}@media (min-width:60rem){.entry-title{width:54rem;left:calc(50% - 54rem / 2)}}@media (min-width:115rem){html{font-size:130%}}a{color:#1863a1}a:visited{color:#751590}a:focus{color:#0181eb}a:hover{color:#0181eb}a:active{color:#01579f}article{outline:0}.basic-alignment{margin-top:.5rem}.basic-alignment.left{float:left;margin-right:.5rem}.basic-alignment.right{float:right;margin-left:.5rem}.link-btn{padding:.8rem 1rem;margin:3rem 0}[role=banner]{color:#555;font-weight:400;text-align:center}[role=banner] a,[role=banner] a:hover,[role=banner] a:visited{color:inherit}header+nav{text-align:center;border-bottom:1px solid rgba(170,170,170,.5);padding:.85rem 0}header+nav ul{list-style:none;margin:0;padding-left:0}header+nav li{display:inline-block}header+nav li+li{margin-top:0;margin-left:1rem}header+nav a{color:#666;text-decoration:none}@media (min-width:960px){header+nav{width:870px;margin:0 auto}}.blog-index .entry-title a,.blog-index .entry-title a:hover,.blog-index .entry-title a:visited{color:#555}.blog-index .intro{font-size:1rem;border:0;margin-left:0;margin-right:0;padding:.9rem;text-align:justify}.blog-index article+article{margin-top:6rem}article header h1{font-size:2.2rem;color:#555;margin-bottom:.32em}article header time{color:#aaa}article .meta{margin-top:0}article a{text-decoration:none}article a:hover{text-decoration:underline}h2 code{font-size:1.4em}.author{display:block}.entry-content{margin:2rem 8px 3rem 8px}#disqus_thread{min-height:1px;max-width:870px;margin:0 auto}.article-cta{text-align:center;margin:3rem 0 3.5rem 0;padding:3rem 0 3.5rem 0;border-width:0;border-top-width:1px;border-bottom-width:1px;border-style:dotted;border-color:rgba(170,170,170,.5);font-size:.95em;line-height:150%}.article-cta>h2{margin-bottom:0}.article-cta>form{margin-bottom:.5rem}[name=subscribe]{margin-top:2rem}[name=subscribe] button,[name=subscribe] input{font-size:1rem;padding:.6rem .5rem}[name=subscribe] input{box-sizing:border-box;width:50%;font-size:1rem;border:2px solid #dbdfe4;border-radius:.25em;outline:0;background-clip:padding-box}[name=subscribe] input:focus{border-color:#268bd2}[name=subscribe] ::placeholder{color:#687a86}[name=subscribe] button{border-radius:.25em;color:#fff;padding-left:1rem;padding-right:1rem;box-shadow:none;background:rgba(88,88,88,.2);border:2px solid transparent;transition:all .2s;cursor:pointer}[name=subscribe] button:active{box-shadow:inset 0 3px 6px #1a6091}[name=subscribe] button:focus,[name=subscribe] input:focus+button{background:#268bd2;border:2px solid #268bd2}@media (min-width:500px){[name=subscribe] input{width:28%;margin-right:2%}}.highlight{margin-left:auto;margin-right:auto;border-radius:3px;font-size:.9rem}.highlight code{box-shadow:inset 0 0 5px 0 rgba(0,0,0,.25)}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:700}.highlight .o{font-weight:700}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:700}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:700;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:700}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kc{font-weight:700}.highlight .kd{font-weight:700}.highlight .kp{font-weight:700}.highlight .kr{font-weight:700}.highlight .kt{color:#458;font-weight:700}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:teal}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:700}.highlight .no{color:teal}.highlight .ni{color:purple}.highlight .ne{color:#900;font-weight:700}.highlight .nf{color:#900;font-weight:700}.highlight .nn{color:#555}.highlight .nt{color:navy}.highlight .nv{color:teal}.highlight .ow{font-weight:700}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:teal}.highlight .vg{color:teal}.highlight .vi{color:teal}.highlight .il{color:#099}.applescript{white-space:pre-wrap}.highlight table td.code{width:100%}.highlight .line-numbers{display:none;text-align:right;line-height:1.45em;background:#fefefe!important;border-right:1px solid #e0e0e0!important;-moz-box-shadow:#fff -1px 0 inset;-webkit-box-shadow:#fff -1px 0 inset;box-shadow:#fff -1px 0 inset;text-shadow:#eaeaea 0 -1px;padding:.8em!important;border-radius:0}.highlight .line-numbers span{color:#93a1a1!important}pre{background:#fbfbfb;border-radius:.4em;font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;border:1px solid #d8d8d8;line-height:1.45em;padding:.8em 1em;color:#586e75;overflow:auto}h3.filename+pre{-moz-border-radius-topleft:0;-webkit-border-top-left-radius:0;border-top-left-radius:0;-moz-border-radius-topright:0;-webkit-border-top-right-radius:0;border-top-right-radius:0}li code,p code{font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;display:inline-block;background:#fff;font-size:.8em;line-height:1.5em;color:#555;border:1px solid #ddd;border-radius:.4em;padding:0 .3em;margin:-1px 0}li pre code,p pre code{font-size:1em!important;background:0 0;border:none}.highlight code,.pre-code{font-family:Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace;overflow:scroll;overflow-y:hidden;display:block;padding:.8em;overflow-x:auto;line-height:1.45em;background:#fbfbfb!important;color:#586e75!important}.highlight code span,.pre-code span{color:#586e75!important}.highlight code span,.pre-code span{font-style:normal!important;font-weight:400!important}.highlight code .c,.pre-code .c{color:#93a1a1!important;font-style:italic!important}.highlight code .cm,.pre-code .cm{color:#93a1a1!important;font-style:italic!important}.highlight code .cp,.pre-code .cp{color:#93a1a1!important;font-style:italic!important}.highlight code .c1,.pre-code .c1{color:#93a1a1!important;font-style:italic!important}.highlight code .cs,.pre-code .cs{color:#93a1a1!important;font-weight:700!important;font-style:italic!important}.highlight code .err,.pre-code .err{color:#dc322f!important;background:0 0!important}.highlight code .k,.pre-code .k{color:#cb4b16!important}.highlight code .o,.pre-code .o{color:#586e75!important;font-weight:700!important}.highlight code .p,.pre-code .p{color:#586e75!important}.highlight code .ow,.pre-code .ow{color:#2aa198!important;font-weight:700!important}.highlight code .gd,.pre-code .gd{color:#586e75!important;background-color:#f3c9c8!important;display:inline-block}.highlight code .gd .x,.pre-code .gd .x{color:#586e75!important;background-color:#f0b5b4!important;display:inline-block}.highlight code .ge,.pre-code .ge{color:#586e75!important;font-style:italic!important}.highlight code .gh,.pre-code .gh{color:#93a1a1!important}.highlight code .gi,.pre-code .gi{color:#586e75!important;background-color:#e3e7c9!important;display:inline-block}.highlight code .gi .x,.pre-code .gi .x{color:#586e75!important;background-color:#ccd497!important;display:inline-block}.highlight code .gs,.pre-code .gs{color:#586e75!important;font-weight:700!important}.highlight code .gu,.pre-code .gu{color:#6c71c4!important}.highlight code .kc,.pre-code .kc{color:#859900!important;font-weight:700!important}.highlight code .kd,.pre-code .kd{color:#268bd2!important}.highlight code .kp,.pre-code .kp{color:#cb4b16!important;font-weight:700!important}.highlight code .kr,.pre-code .kr{color:#d33682!important;font-weight:700!important}.highlight code .kt,.pre-code .kt{color:#2aa198!important}.highlight code .n,.pre-code .n{color:#268bd2!important}.highlight code .na,.pre-code .na{color:#268bd2!important}.highlight code .nb,.pre-code .nb{color:#859900!important}.highlight code .nc,.pre-code .nc{color:#d33682!important}.highlight code .no,.pre-code .no{color:#b58900!important}.highlight code .nl,.pre-code .nl{color:#859900!important}.highlight code .ne,.pre-code .ne{color:#268bd2!important;font-weight:700!important}.highlight code .nf,.pre-code .nf{color:#268bd2!important;font-weight:700!important}.highlight code .nn,.pre-code .nn{color:#b58900!important}.highlight code .nt,.pre-code .nt{color:#268bd2!important;font-weight:700!important}.highlight code .nx,.pre-code .nx{color:#b58900!important}.highlight code .vg,.pre-code .vg{color:#268bd2!important}.highlight code .vi,.pre-code .vi{color:#268bd2!important}.highlight code .nv,.pre-code .nv{color:#268bd2!important}.highlight code .mf,.pre-code .mf{color:#2aa198!important}.highlight code .m,.pre-code .m{color:#2aa198!important}.highlight code .mh,.pre-code .mh{color:#2aa198!important}.highlight code .mi,.pre-code .mi{color:#2aa198!important}.highlight code .s,.pre-code .s{color:#2aa198!important}.highlight code .sd,.pre-code .sd{color:#2aa198!important}.highlight code .s2,.pre-code .s2{color:#2aa198!important}.highlight code .se,.pre-code .se{color:#dc322f!important}.highlight code .si,.pre-code .si{color:#268bd2!important}.highlight code .sr,.pre-code .sr{color:#2aa198!important}.highlight code .s1,.pre-code .s1{color:#2aa198!important}.highlight code div .gd,.highlight code div .gd .x,.highlight code div .gi,.highlight code div .gi .x,.pre-code div .gd,.pre-code div .gd .x,.pre-code div .gi,.pre-code div .gi .x{display:inline-block;width:100%}.highlight{margin-bottom:1.8em;background:#fbfbfb;overflow-y:hidden;overflow-x:auto}.highlight pre{background:0 0;border-radius:0;border:none;padding:0;margin:0}.highlight code{background:#000;text-align:left}main+footer{text-align:center;margin:3rem 0}main+footer a{text-decoration:none}main+footer a:hover svg{transform:scale(1.05);opacity:1}main+footer svg{transition:transform .15s,opacity .15s;opacity:.95;height:3.5rem}.footer-social{max-width:720px;margin:3rem auto 0 auto}@media (min-width:48rem){svg{padding:0 1.5rem}}@media (prefers-color-scheme:dark){html,li code,p code,pre{background:#181a1b!important;color:#e8e6e3}.blog-archives a,.entry-title,h1{color:#c9c5be}.entry-title a{color:inherit!important}a{color:#7abbeb}a:visited{color:#d683ed}a:focus{color:#40acfe}a:hover{color:#40acfe}a:active{color:#6dc0fe}header+nav{background:rgba(24,26,27,.95)}#blog-archives article a,[role=banner] a,header+nav a{color:#c9c5be!important}div.category-index article+article h1,header+nav,li code,p code,pre{border-color:#3a3a3a}.highlight{background-color:#0e1010;border-color:#2f2f2f!important}.highlight code{background-color:#0e1010!important}[name=subscribe] input{border-color:#2f2f2f;background-color:rgba(44,44,44,.2);color:#fff}[name=subscribe] input:focus{background-color:#fff;color:#000}}</style><link href=https://feeds.feedburner.com/simonewebdesign rel=alternate title="Simone Web Design"type=application/atom+xml><header><h1 role=banner><a href=/ >Simone Web Design</a></h1></header><nav><ul><li><a href=/ >Home</a><li><a href=/archives/ >Blog</a><li><a href=/projects/ >Projects</a><li><a href=/about/ >About</a></ul></nav><main><div><article class=hentry tabindex=-1><header><h1 class=entry-title>Rails 4: update/synchronize views with database schema after a migration</h1><p class=meta><time>9th Feb 2014</time></header><div class=entry-content><p>So you just updated your model and the related database schema, but your views are now obsolete. How to refresh them?<p>Well, there are a lot of premises to say here. First, <strong>there&#8217;s no actual way to synchronize your views with your model.</strong> The best way is to <strong>do it manually</strong>, but it&#8217;s not the <em>only</em> way. The other way, which I&#8217;m going to explain in this post, actually only works if you are willing to <em>scaffold</em> your whole model/view/controller/tests from scratch. This is probably not desirable in most of cases, but I assure you can safely try this path if you are in a early stage of development, or if you are ok with the default (generated) Rails&#8217; views. So, whatever, if you don&#8217;t want to <code>rake generate scaffold your_resource</code> again, you can stop reading now.<hr><p>Oh well, you are still reading :-)<p>I&#8217;ll proceed explaining how to synchronize your views after the migration(s) you have run. Let&#8217;s just start from scratch.<h2>A full example</h2><p>Let&#8217;s say we have these two models: <code>Child</code> and <code>Toy</code>.<h3 id=child>Child</h3><ul><li>name<li>birth_date</ul><h3 id=toy>Toy</h3><ul><li>description<li>price<li>child_id</ul><p>As you might have already guessed, I am going to tie our models with a <em>one-to-many</em> relationship: a child <code>has_many</code> toys, and a toy <code>belongs_to</code> a child.<div class="highlighter-rouge language-ruby"><div class=highlight><pre class=highlight><code><span class=c1># app/models/child.rb</span>
<span class=k>class</span> <span class=nc>Child</span> <span class=o>&gt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Base</span>
  <span class=n>has_many</span> <span class=ss>:toys</span>
<span class=k>end</span>
</code></pre></div></div><div class="highlighter-rouge language-ruby"><div class=highlight><pre class=highlight><code><span class=c1># app/models/toy.rb</span>
<span class=k>class</span> <span class=nc>Toy</span> <span class=o>&gt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Base</span>
  <span class=n>belongs_to</span> <span class=ss>:child</span>
<span class=k>end</span>
</code></pre></div></div><p>Let's create the application and scaffold these resources:<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails new DemoApp <span class=o>&amp;&amp;</span> <span class=nb>cd </span>DemoApp
</code></pre></div></div><div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails generate scaffold child name birth_date:date

<span class=nv>$ </span>rails generate scaffold toy description price:decimal child:references
</code></pre></div></div><p>Run the migrations:<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rake db:migrate
<span class=o>==</span>  CreateChildren: migrating <span class=o>=================================================</span>
<span class=nt>--</span> create_table<span class=o>(</span>:children<span class=o>)</span>
   -&gt; 0.0014s
<span class=o>==</span>  CreateChildren: migrated <span class=o>(</span>0.0015s<span class=o>)</span> <span class=o>========================================</span>

<span class=o>==</span>  CreateToys: migrating <span class=o>=====================================================</span>
<span class=nt>--</span> create_table<span class=o>(</span>:toys<span class=o>)</span>
   -&gt; 0.0028s
<span class=o>==</span>  CreateToys: migrated <span class=o>(</span>0.0029s<span class=o>)</span> <span class=o>============================================</span>
</code></pre></div></div><p>We can now start the server and check that everything went good.<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails s
<span class=o>=&gt;</span> Booting WEBrick
<span class=o>=&gt;</span> Rails 4.1.0.beta1 application starting <span class=k>in </span>development on http://0.0.0.0:3000
...
</code></pre></div></div><p><img alt="listing children empty"loading=lazy src=/images/1-listing-children.png><p>It looks fine, except for one thing: there's no data displayed! Let's add some entries manually.<p><img alt="listing children"loading=lazy src=/images/2-listing-children.png><p>Good. Now let's give some toys to our boys:<p><img alt="toy successfully created"loading=lazy src=/images/3-toy-created.png><p>Done. But wait a minute: this view looks a bit... crappy, doesn't it? We don't want to see a reference to a child... just his/her name. Even the prices don't look right.<p>Let's generate the scaffold again, with some corrections.<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails g scaffold toy description:string<span class=o>{</span>50<span class=o>}</span> price:decimal<span class=o>{</span>4,2<span class=o>}</span>
      invoke  active_record
Another migration is already named create_toys: /Users/simo/Projects/DemoApp/db/migrate/20140209145850_create_toys.rb. Use <span class=nt>--force</span> to remove the old migration file and replace it.
</code></pre></div></div><p>Fair enough. We must destroy the entire scaffold before recreating it.<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails destroy scaffold toy
      invoke  active_record
      remove    db/migrate/20140208224426_create_toys.rb
      remove    app/models/toy.rb
      remove    ...

<span class=nv>$ </span>rails generate scaffold toy description:string<span class=o>{</span>50<span class=o>}</span> price:decimal<span class=o>{</span>4,2<span class=o>}</span> child:references
      invoke  active_record
      create    db/migrate/20140209145850_create_toys.rb
      create    app/models/toy.rb
      create    ...
</code></pre></div></div><p>Ok. Let's give a quick look at the generated migration.<div class="highlighter-rouge language-ruby"><div class=highlight><pre class=highlight><code><span class=k>class</span> <span class=nc>CreateToys</span> <span class=o>&gt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Migration</span>
  <span class=k>def</span> <span class=nf>change</span>
    <span class=n>create_table</span> <span class=ss>:toys</span> <span class=k>do</span> <span class=o>|</span><span class=n>t</span><span class=o>|</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>string</span> <span class=ss>:description</span><span class=p>,</span> <span class=ss>limit: </span><span class=mi>50</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>decimal</span> <span class=ss>:price</span><span class=p>,</span> <span class=ss>precision: </span><span class=mi>4</span><span class=p>,</span> <span class=ss>scale: </span><span class=mi>2</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>references</span> <span class=ss>:child</span><span class=p>,</span> <span class=ss>index: </span><span class=kp>true</span>

      <span class=n>t</span><span class=p>.</span><span class=nf>timestamps</span>
    <span class=k>end</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div><p>It looks right. Let's run it!<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rake db:migrate
<span class=o>==</span>  CreateToys: migrating <span class=o>=====================================================</span>
<span class=nt>--</span> create_table<span class=o>(</span>:toys<span class=o>)</span>
rake aborted!
An error has occurred, this and all later migrations canceled:

SQLite3::SQLException: table <span class=s2>"toys"</span> already exists: CREATE TABLE <span class=s2>"toys"</span> <span class=o>(</span><span class=s2>"id"</span> INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, <span class=s2>"description"</span> varchar<span class=o>(</span>50<span class=o>)</span>, <span class=s2>"price"</span> decimal<span class=o>(</span>4,2<span class=o>)</span>, <span class=s2>"child_id"</span> integer, <span class=s2>"created_at"</span> datetime, <span class=s2>"updated_at"</span> datetime<span class=o>)</span> /Users/simo/.rvm/gems/ruby-2.0.0-p353/gems/sqlite3-1.3.8/lib/sqlite3/database.rb:91:in <span class=sb>`</span>initialize<span class=s1>'
</span></code></pre></div></div><p>Whoops! The table already exists. We should remove it first. Edit the migration:<div class="highlighter-rouge language-ruby"><div class=highlight><pre class=highlight><code><span class=k>class</span> <span class=nc>CreateToys</span> <span class=o>&gt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Migration</span>
  <span class=k>def</span> <span class=nf>change</span>
    <span class=c1># This will do the work</span>
    <span class=n>drop_table</span> <span class=ss>:toys</span>

    <span class=n>create_table</span> <span class=ss>:toys</span> <span class=k>do</span> <span class=o>|</span><span class=n>t</span><span class=o>|</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>string</span> <span class=ss>:description</span><span class=p>,</span> <span class=ss>limit: </span><span class=mi>50</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>decimal</span> <span class=ss>:price</span><span class=p>,</span> <span class=ss>precision: </span><span class=mi>4</span><span class=p>,</span> <span class=ss>scale: </span><span class=mi>2</span>
      <span class=n>t</span><span class=p>.</span><span class=nf>references</span> <span class=ss>:child</span><span class=p>,</span> <span class=ss>index: </span><span class=kp>true</span>

      <span class=n>t</span><span class=p>.</span><span class=nf>timestamps</span>
    <span class=k>end</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div><p>And migrate again:<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rake db:migrate
<span class=o>==</span>  CreateToys: migrating <span class=o>=====================================================</span>
<span class=nt>--</span> drop_table<span class=o>(</span>:toys<span class=o>)</span>
   -&gt; 0.0107s
<span class=nt>--</span> create_table<span class=o>(</span>:toys<span class=o>)</span>
   -&gt; 0.0109s
<span class=o>==</span>  CreateToys: migrated <span class=o>(</span>0.0220s<span class=o>)</span> <span class=o>============================================</span>
</code></pre></div></div><p>Ok, we are ready to start the server again and see what changed.<div class="highlighter-rouge language-bash"><div class=highlight><pre class=highlight><code><span class=nv>$ </span>rails s
</code></pre></div></div><p>That's it. This is basically the process. It's way too labourious, I know, but the truth is that we just can't efficiently automate a process like this, because: what if we generate more migrations during the journey? We would have to delete them and recreate again the whole schema by running <code>rails generate scaffold</code>, <code>rake db:reset</code> and rerun the generate again and again... well, that sucks. At this stage we've got the point: it's better to do it manually! Rails gives us tons of helper methods to format prices and get things done, and that's definitely the path to follow.<p>If you are still not convinced, you can check this <a href=https://stackoverflow.com/questions/1732135/question-regarding-rails-migration-and-synchronizing-views>question on StackOverflow</a>. Basically, it's almost the same question I had before writing this post. Both the question and the answer are quite old, and in the meantime the Rails Team didn't develop anything that would help us regenerating our views. This probably means <strong>we are not supposed to do it</strong>, don't you think? However, if your goal is to get focused on the backend without having to deal with the frontend, you can always use a gem like <a href=https://github.com/activescaffold/active_scaffold title="Save time and headaches, and create a more easily maintainable set of pages, with ActiveScaffold. ActiveScaffold handles all your CRUD (create, read, update, delete) user interface needs, leaving you more time to focus on more challenging (and interesting!) problems."><code>ActiveScaffold</code></a>. But you have been warned!<p>I hope you've found this article useful; thoughts are welcome, as always. If you want you can leave a comment below.</div><footer><p class=meta><span class="author byline vcard">Posted by <span class=fn>Simone Vittori</span></span> <time>9th Feb 2014</time></footer></article></div></main><footer><div id="disqus_thread" aria-live="polite"></div><script>var disqus_config=function(){this.page.url="https://www.simonewebdesign.it/",this.page.identifier="https://www.simonewebdesign.it/ruby-on-rails-synchronize-views-database-after-migration/"},o=new IntersectionObserver(function(e){e[0].isIntersecting&&function(){o.disconnect();var e=document,t=e.createElement("script");t.src="https://simonewebdesign.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()});o.observe(document.querySelector("#disqus_thread"))</script><noscript>Please enable JavaScript to view the comments.</noscript><div class=footer-social><a href=https://twitter.com/simonewebdesign rel=external><svg aria-label=Twitter role=img viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"fill=#444 /></svg> </a><a href=https://www.linkedin.com/in/simonewebdesign rel=external><svg aria-label=LinkedIn role=img viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg fill=#444><circle cx=142 cy=138 r=37 /><path d="M244 194v198M142 194v198"stroke=#444 stroke-width=66 /><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg> </a><a href=https://github.com/simonewebdesign rel=external><svg aria-label=GitHub role=img viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"fill=#444 /></svg> </a><a href=https://stackoverflow.com/users/801544/simone rel=external><svg aria-label="Stack Overflow"role=img viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><path d="M293 89l90 120zm-53 50l115 97zm-41 65l136 64zm-23 69l148 31zm-6 68h150zm-45-44v105h241V297"fill=none stroke=#444 stroke-width=30 /></svg> </a><a href=/atom.xml><svg aria-label=RSS role=img viewBox="0 0 512 512"xmlns=http://www.w3.org/2000/svg><circle cx=145 cy=367 r=35 fill=#444 /><path d="M109 241c89 0 162 73 162 162M109 127c152 0 276 124 276 276"fill=none stroke=#444 stroke-width=60 /></svg></a></div><style media=print>footer a{display:none}</style></footer><script>navigator.serviceWorker.controller||navigator.serviceWorker.register("/sw.js")</script>